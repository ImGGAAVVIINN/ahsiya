<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Video System</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
        #videoContainer {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        video {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
        }
        #redirectCircle {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="videoContainer">
        <video id="videoPlayer" autoplay muted></video>
        <div id="redirectCircle"></div>
    </div>
    
    <script>
        const videoLinks = [
        'https://cdn.discordapp.com/attachments/1276549972547993671/1276874853902712978/ahsiya-intro.mp4?ex=66cb1de0&is=66c9cc60&hm=8c2c4e60689c7840efe5f85593ac868df66f090331773e52d579b340848af6d9&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1276570423240429658/ezgif-6-133c5dcada.mp4?ex=66ca025a&is=66c8b0da&hm=351c0be8c99b5047070fe9dbbc8dee77ca14130cf14326681275a3d05d11cb8b&',
        'https://scontent.xx.fbcdn.net/v/t42.3356-2/442418438_7954436024587296_2927986135207136767_n.mp4?_nc_cat=109&ccb=1-7&_nc_sid=4f86bc&_nc_ohc=vD2srcxYj9EQ7kNvgEFCdzT&_nc_ht=scontent.xx&oh=03_Q7cD1QEER886Gwt2WVQlhy7-6Kv5I4fIePk_iGRH6r3c_h1kUA&oe=66CA7457&dl=1',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1268921770753130526/lv_0_20240802225004.mp4?ex=66c9de7d&is=66c88cfd&hm=4e759bc9df503482a2c0f7592e906b72d53c73cb37f1c32c0046efb873f812eb&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1264203260840120473/lv_0_20240720225010.mp4?ex=66c9d789&is=66c88609&hm=ce8d0c64624af472a3068e7c681ad906336826ce0a4e7451a664bf0547186ea3&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1248577383670222878/RDT_20240606_121101.mp4?ex=66c9af4d&is=66c85dcd&hm=8e506932cfec7a2666d6c66783049e16917783422ccd92d0b4a96cd0581de991&',
        'https://media.discordapp.net/attachments/1008572901382951012/1248577367169962074/RDT_20240606_122958.mp4?ex=66c9af49&is=66c85dc9&hm=bfbf42eeb7fc2a53ab3e6180065983e95e95e7cc3b612486ca136d7880ef0426&', 
        'https://media.discordapp.net/attachments/1008572901382951012/1248577368402952232/RDT_20240606_122415.mp4?ex=66c9af4a&is=66c85dca&hm=affe06826f014d1db6dc0c95732c00e932a908a43ea588157df204ed707f9b7d&',
        'https://media.discordapp.net/attachments/1008572901382951012/1248577367824269312/RDT_20240606_122923.mp4?ex=66c9af49&is=66c85dc9&hm=c767030f46f690d9d5f09c4b5014e3cf81d7d1903fc7b71cceb6d3761ba7ce0d&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1244257700431396894/3459215cf4440cab50322ac6a685325a.mp4?ex=66c9ca48&is=66c878c8&hm=8cd54f868f61621741afaf8c834f4b578b76a1196dcff72527565ddd32046c67&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1243866549232734248/RDT_20240525_192752.mp4?ex=66c9af7f&is=66c85dff&hm=4a434d5c42c9114c731dd344570f191c72aa881e111cf2cd2a67fa5a5365fb0d&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1243510036781731850/lv_0_20240524202351.mp4?ex=66c9b4f8&is=66c86378&hm=97f77982f6f2c27df395d0534fc213462a0172fcde7ee0aa88f17f606145df89&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1243492185572118580/5baf2b70b18ef7c3d0e4d11bacd7c344.mp4?ex=66c9a458&is=66c852d8&hm=04db736d3a6198d9932fb01f5fda92b8bb8dc55125e69a2e350791c3b9951fe8&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1241362454722904215/lv_0_20240518220937.mp4?ex=66c9cde0&is=66c87c60&hm=2df1b94f1a9977f5248662747a95ef3fc702ae55d8252fde6dbce609614555c4&',
        'https://cdn.discordapp.com/attachments/1008572901382951012/1235544161558728805/d40d1674dc398792c742c6097c29de11.mp4?ex=66c9bb2b&is=66c869ab&hm=b0606505913eb0cc0c9d152546e5d225ae79dde8ea0e4d2c5fd710ca63b8028c&',
        ];

        let currentIndex = 0;
        let videoHistory = [];
        const maxHistorySize = 5; // Maximum number of recent videos to track
        const swipeThreshold = 0.5; // Threshold for swipe detection (50% of screen width)
        const firstVideoIndex = 0; // Index of the first video

        const videoPlayer = document.getElementById('videoPlayer');
        const redirectCircle = document.getElementById('redirectCircle');
        let videoList = [...videoLinks]; // Clone videoLinks to manage video removal
        let interacted = false; // To track if user has interacted

        function playVideo(index) {
            videoPlayer.src = videoList[index];
            videoPlayer.controls = (index !== firstVideoIndex); // Hide controls for the first video
            videoPlayer.muted = !interacted; // Mute initially if no user interaction
            videoPlayer.play();

            // Show the redirect circle only for the first video
            if (index === firstVideoIndex) {
                redirectCircle.style.display = 'block';
            } else {
                redirectCircle.style.display = 'none';
            }
        }

        function adjustVideoSize() {
            const container = document.getElementById('videoContainer');
            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight;
            const videoAspectRatio = videoPlayer.videoWidth / videoPlayer.videoHeight;

            if (containerWidth / containerHeight > videoAspectRatio) {
                videoPlayer.style.width = 'auto';
                videoPlayer.style.height = '100%';
            } else {
                videoPlayer.style.width = '100%';
                videoPlayer.style.height = 'auto';
            }
        }

        videoPlayer.addEventListener('loadedmetadata', adjustVideoSize);

        function getRandomIndex(excludeIndexes) {
            let randomIndex;
            const validIndexes = videoList
                .map((_, index) => index)
                .filter(index => !excludeIndexes.includes(index));
            
            if (validIndexes.length === 0) {
                return excludeIndexes[Math.floor(Math.random() * excludeIndexes.length)];
            }
            
            randomIndex = validIndexes[Math.floor(Math.random() * validIndexes.length)];
            return randomIndex;
        }

        function swipeLeft() {
            if (videoHistory.length > 0) {
                currentIndex = videoHistory.pop();
                playVideo(currentIndex);
            }
        }

        function swipeRight() {
            videoHistory.push(currentIndex);
            if (videoHistory.length > maxHistorySize) {
                videoHistory.shift(); // Keep the history size within the limit
            }
            if (videoList.length === 0) {
                // No more videos to choose from
                return;
            }
            currentIndex = getRandomIndex(videoHistory);
            if (currentIndex === firstVideoIndex) {
                // Avoid selecting the first video again
                currentIndex = getRandomIndex(videoHistory);
            }
            playVideo(currentIndex);
        }

        function handleTouchStart(evt) {
            const firstTouch = evt.touches[0];
            xDown = firstTouch.clientX;
            windowWidth = window.innerWidth;
        }

        function handleTouchMove(evt) {
            if (!xDown) {
                return;
            }

            let xUp = evt.touches[0].clientX;
            let xDiff = xDown - xUp;

            if (Math.abs(xDiff) > windowWidth * swipeThreshold) {
                interacted = true; // Set interacted to true on swipe

                if (currentIndex !== firstVideoIndex) { // Allow swiping only if it's not the first video
                    if (xDiff > 0) {
                        swipeRight(); // Swipe right advances to a new random video
                    } else {
                        swipeLeft(); // Swipe left goes back to the previous video
                    }
                }

                xDown = null; // Reset value
            }
        }

        let xDown = null;
        let windowWidth = window.innerWidth;

        document.addEventListener('touchstart', handleTouchStart, false);
        document.addEventListener('touchmove', handleTouchMove, false);

        // Redirect to the second video when the circle is clicked
        redirectCircle.addEventListener('click', () => {
            playVideo(1); // Play the second video (index 1)
        });

        // Initial video play
        playVideo(currentIndex);
    </script>
</body>
</html>
