<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AHSIYA</title>
    <style>
        #videoContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #000;
    overflow: hidden;
}

video {
    max-width: 100%;
    max-height: 100%;
    width: auto;
    height: auto;
    object-fit: contain; /* Ensure video maintains aspect ratio and stays within the container */
}

#redirectCircle {
    position: absolute;
    width: 150px;
    height: 150px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: none;
    cursor: pointer;
    z-index: 10;
}


    </style>
</head>
<body>

    <div id="videoContainer">
        <video id="videoPlayer" autoplay muted></video>
        <div id="redirectCircle"></div>
    </div>
    
    <script>
        const videoLinks = [
            //intro
            'https://link.storjshare.io/s/jvjd3ugvdzm7nldzvwhsgvhjbyva/aa1/ahsiya-intro.mp4?wrap=0',
            //aa1
            'https://link.storjshare.io/s/jvxn35xgelqcm7tl5hi2fxis3znq/aa1/3459215cf4440cab50322ac6a685325a.mp4?wrap=0',
            'https://link.storjshare.io/s/ju65abpq632sattq2opcs7viqwqq/aa1/46520cc4d47c81df1b27535fef2c0188.mp4?wrap=0',
            'https://link.storjshare.io/s/ju63p4hashw5wnbyqoxwrr3rtf7a/aa1/5baf2b70b18ef7c3d0e4d11bacd7c344.mp4?wrap=0',
            'https://link.storjshare.io/s/jxr23zl3vj5vk6y4k6gzikaqviha/aa1/d40d1674dc398792c742c6097c29de11.mp4?wrap=0',
            'https://link.storjshare.io/s/jwvpmovwpc3ji26f7cdjj2pamo7a/aa1/lv_0_20240518220937.mp4?wrap=0',
            'https://link.storjshare.io/s/jukdccdueyzblwh4gjmetkmrv5wq/aa1/lv_0_20240524202351.mp4?wrap=0',
            'https://link.storjshare.io/s/jwactszzqzdbvlad7mpksfycxw7a/aa1/lv_0_20240720225010.mp4?wrap=0',
            'https://link.storjshare.io/s/jxillvoc62ohmz73ibtwt6mfe2kq/aa1/lv_0_20240802225004.mp4?wrap=0',
            'https://link.storjshare.io/s/jwvqkq5c6npabw2yveou6epcjrtq/aa1/RDT_20240525_192752.mp4?wrap=0',
        ];

        let currentIndex = 0;
        let videoHistory = [];
        let futureVideos = [];
        let lastTenVideos = [];
        const maxHistorySize = 5;
        const maxLastTenSize = 10;
        const swipeThreshold = 0.2;
        const firstVideoIndex = 0;

        const videoPlayer = document.getElementById('videoPlayer');
        const redirectCircle = document.getElementById('redirectCircle');
        let videoList = [...videoLinks];
        let interacted = false;

        function playVideo(index) {
            currentIndex = index;
            videoPlayer.src = videoList[index];
            videoPlayer.controls = (index !== firstVideoIndex);
            videoPlayer.muted = (index === firstVideoIndex) ? !interacted : false;
            videoPlayer.loop = (index !== firstVideoIndex);
            videoPlayer.play();
            
            // Display the redirectCircle only for the first video
            redirectCircle.style.display = (index === firstVideoIndex) ? 'block' : 'none';
            centerRedirectCircle(); // Ensure the circle stays centered
        }

        function adjustVideoSize() {
            const videoAspectRatio = videoPlayer.videoWidth / videoPlayer.videoHeight;
            const windowAspectRatio = window.innerWidth / window.innerHeight;

            if (windowAspectRatio > videoAspectRatio) {
                videoPlayer.style.width = '100%';
                videoPlayer.style.height = 'auto';
            } else {
                videoPlayer.style.width = 'auto';
                videoPlayer.style.height = '100%';
            }
        }

        // This keeps the redirectCircle and video centered and functional
        function centerRedirectCircle() {
            const redirectCircle = document.getElementById('redirectCircle');
            redirectCircle.style.top = '50%';
            redirectCircle.style.left = '50%';
            redirectCircle.style.transform = 'translate(-50%, -50%)';
        }

        window.addEventListener('resize', () => {
            adjustVideoSize();
            centerRedirectCircle(); // Center the redirectCircle
        });

        document.addEventListener('DOMContentLoaded', () => {
            adjustVideoSize();
            centerRedirectCircle(); // Ensure redirectCircle is centered on load
        });

        videoPlayer.addEventListener('loadeddata', () => {
            adjustVideoSize();
            centerRedirectCircle(); // Recenter after video data is loaded
        });


        window.addEventListener('resize', adjustVideoSize); // Adjust video size on window resize

        function getRandomIndex(excludeIndexes) {
            let randomIndex;
            const validIndexes = videoList
                .map((_, index) => index)
                .filter(index => !excludeIndexes.includes(index) && index !== firstVideoIndex); // Exclude first video and recent 10

            if (validIndexes.length === 0) {
                return excludeIndexes[Math.floor(Math.random() * excludeIndexes.length)];
            }

            randomIndex = validIndexes[Math.floor(Math.random() * validIndexes.length)];
            return randomIndex;
        }

        function swipeLeft() {
            if (currentIndex === firstVideoIndex) {
                // If the current video is the first video, do not allow swiping
                return;
            }

            if (videoHistory.length > 0) {
                const previousIndex = videoHistory.pop();
                futureVideos.push(currentIndex); // Remember future videos
                playVideoWithAnimation(previousIndex, 'right');
            }
        }

        function swipeRight() {
            if (currentIndex === firstVideoIndex) {
                // If the current video is the first video, do not allow swiping
                return;
            }

            if (futureVideos.length > 0) {
                const nextIndex = futureVideos.pop();
                videoHistory.push(currentIndex); // Keep current video in history
                playVideoWithAnimation(nextIndex, 'left');
            } else {
                videoHistory.push(currentIndex);
                if (videoHistory.length > maxHistorySize) {
                    videoHistory.shift(); // Keep history within limit
                }

                const newIndex = getRandomIndex([...videoHistory, ...lastTenVideos, currentIndex]);
                playVideoWithAnimation(newIndex, 'left');
            }
        }


        function playVideoWithAnimation(newIndex, direction) {
    const oldVideoPlayer = videoPlayer.cloneNode();
    oldVideoPlayer.src = videoPlayer.src;

    // Append the cloned video player to the container for the transition effect
    videoContainer.appendChild(oldVideoPlayer);

    // Set the initial position of the new video player based on the swipe direction
    videoPlayer.style.transform = (direction === 'left') ? 'translateX(200%)' : 'translateX(-200%)';
    oldVideoPlayer.style.transform = 'translateX(0)';

    // Start playing the new video
    playVideo(newIndex);

    // Allow the browser to recognize the changes by setting a timeout
    setTimeout(() => {
        // Move old video out further left and new video in from the right
        oldVideoPlayer.style.transform = (direction === 'left') ? 'translateX(-200%)' : 'translateX(200%)';
        videoPlayer.style.transform = 'translateX(0)';
    }, 10);

    // Clean up the old video player after the transition
    oldVideoPlayer.addEventListener('transitionend', () => {
        videoContainer.removeChild(oldVideoPlayer);
    });

    // Set the transition duration for smooth animations
    oldVideoPlayer.style.transition = 'transform 0.7s ease';  // Adjusted to 0.7s for smoother transition
    videoPlayer.style.transition = 'transform 0.7s ease';
}





        function handleTouchStart(evt) {
            const firstTouch = evt.touches[0];
            xDown = firstTouch.clientX;
            windowWidth = window.innerWidth;
        }

        function handleTouchMove(evt) {
            if (!xDown) return;

            const xUp = evt.touches[0].clientX;
            const xDiff = xDown - xUp;

            if (Math.abs(xDiff) > windowWidth * swipeThreshold) {
                interacted = true;
                if (xDiff > 0) {
                    swipeRight();
                } else {
                    swipeLeft();
                }
                xDown = null;
            }
        }

        let xDown = null;
        let windowWidth = window.innerWidth;

        document.addEventListener('touchstart', handleTouchStart, false);
        document.addEventListener('touchmove', handleTouchMove, false);

        redirectCircle.addEventListener('click', () => {
            const randomIndex = getRandomIndex([currentIndex, firstVideoIndex]);
            playVideo(randomIndex);
        });

        playVideo(currentIndex);
    </script>
</body>
</html>
