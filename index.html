<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Video System</title>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            overflow: hidden;
            background-color: #000;
        }
        #videoContainer {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        video {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
        }
        #redirectCircle {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="videoContainer">
        <video id="videoPlayer" autoplay muted></video>
        <div id="redirectCircle"></div>
    </div>
    
    <script>
        const videoLinks = [
        'https://cdn.discordapp.com/attachments/1276549972547993671/1276874853902712978/ahsiya-intro.mp4?ex=66cb1de0&is=66c9cc60&hm=8c2c4e60689c7840efe5f85593ac868df66f090331773e52d579b340848af6d9&',
        'https://instagram.fmel5-1.fna.fbcdn.net/v/t15.3394-10/456676786_7967887846628857_6352364672529438928_n.jpg?stp=dst-jpg_s552x414&_nc_cat=103&ccb=1-7&_nc_sid=569220&_nc_ohc=cFe-sl0P2M0Q7kNvgHGsH_V&_nc_ht=instagram.fmel5-1.fna&oh=03_Q7cD1QH_hrxpoYtsDSi7Vevq9JuyA9OgkEi-NRbtcrjTk7duNw&oe=66CFB708',
        'https://scontent.cdninstagram.com/v/t51.29350-15/454642957_1018795969986480_4641076446978688214_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=18de74&_nc_ohc=CAxY6eGCjcwQ7kNvgH43x_n&_nc_ht=scontent.cdninstagram.com&oh=00_AYDawF-D8zlWZSjm4CRj6ZoU2VcDCpN8mmPMvyJ1Od8k9g&oe=66CFB836',
        'https://instagram.fmel5-1.fna.fbcdn.net/v/t15.3394-10/456535215_9122404307774551_7140050560380870302_n.jpg?stp=dst-jpg_p180x540&_nc_cat=104&ccb=1-7&_nc_sid=569220&_nc_ohc=4J6OHkEuQm4Q7kNvgG4EnG4&_nc_ht=instagram.fmel5-1.fna&oh=03_Q7cD1QGkI9OLsnFDuFyDqmB22s_NhURfnKKeiu-_g_K0e48t1g&oe=66CF9393',
        'https://instagram.fmel5-1.fna.fbcdn.net/v/t15.3394-10/456550195_7753042458138924_5526818192417165436_n.jpg?stp=dst-jpg_s843x403&_nc_cat=107&ccb=1-7&_nc_sid=569220&_nc_ohc=XPKx27RK8CsQ7kNvgFvlaOm&_nc_ht=instagram.fmel5-1.fna&oh=03_Q7cD1QEPa6K1FZViEK1C6J_Do3BbdA23YfFxmqnonacNtkyBBg&oe=66CFBB3E',
        'https://instagram.fmel5-1.fna.fbcdn.net/v/t15.3394-10/456681420_8259289000805839_2505635880902865479_n.jpg?stp=dst-jpg_s403x403&_nc_cat=108&ccb=1-7&_nc_sid=569220&_nc_ohc=BCGM_kJpYpcQ7kNvgGSZfIR&_nc_ht=instagram.fmel5-1.fna&oh=03_Q7cD1QG2dN6UpYC7PxQXgBoYMgzEUEBvoCVk3PMUe8n54Bv8Lw&oe=66CF9BD1',
        'https://instagram.fmel5-1.fna.fbcdn.net/v/t15.3394-10/456439841_8614311791912431_3342882589452863563_n.jpg?stp=dst-jpg_s843x403&_nc_cat=101&ccb=1-7&_nc_sid=569220&_nc_ohc=WX2Dcp9sRzwQ7kNvgHmczNF&_nc_ht=instagram.fmel5-1.fna&oh=03_Q7cD1QHuIq9-rXOI2Zca3-gHK_C01S58c-FS3VtEwTpkJrHLvQ&oe=66CFBB10',
        'https://instagram.fmel5-1.fna.fbcdn.net/v/t15.3394-10/456071048_7887168654729213_6997331460790678943_n.jpg?stp=dst-jpg_s403x403&_nc_cat=109&ccb=1-7&_nc_sid=569220&_nc_ohc=sA4fT5CGaM0Q7kNvgFWI7Jc&_nc_ht=instagram.fmel5-1.fna&oh=03_Q7cD1QHrFrfh_LQ8ru_tJo89AL_B2hS1auQIenorIRPKOQRjCg&oe=66CFA2CF',
        ];

        let currentIndex = 0;
        let videoHistory = [];
        const maxHistorySize = 5; // Maximum number of recent videos to track
        const swipeThreshold = 0.5; // Threshold for swipe detection (50% of screen width)
        const firstVideoIndex = 0; // Index of the first video

        const videoPlayer = document.getElementById('videoPlayer');
        const redirectCircle = document.getElementById('redirectCircle');
        let videoList = [...videoLinks]; // Clone videoLinks to manage video removal
        let interacted = false; // To track if user has interacted

        function playVideo(index) {
            currentIndex = index;
            videoPlayer.src = videoList[index];
            videoPlayer.controls = (index !== firstVideoIndex); // Hide controls for the first video
            videoPlayer.muted = !interacted; // Mute initially if no user interaction
            videoPlayer.play();

            // Show the redirect circle only for the first video
            if (index === firstVideoIndex) {
                redirectCircle.style.display = 'block';
            } else {
                redirectCircle.style.display = 'none';
            }
        }

        function adjustVideoSize() {
            const container = document.getElementById('videoContainer');
            const containerWidth = container.clientWidth;
            const containerHeight = container.clientHeight;
            const videoAspectRatio = videoPlayer.videoWidth / videoPlayer.videoHeight;

            if (containerWidth / containerHeight > videoAspectRatio) {
                videoPlayer.style.width = 'auto';
                videoPlayer.style.height = '100%';
            } else {
                videoPlayer.style.width = '100%';
                videoPlayer.style.height = 'auto';
            }
        }

        videoPlayer.addEventListener('loadedmetadata', adjustVideoSize);

        function getRandomIndex(excludeIndexes) {
            let randomIndex;
            const validIndexes = videoList
                .map((_, index) => index)
                .filter(index => !excludeIndexes.includes(index));
            
            if (validIndexes.length === 0) {
                return excludeIndexes[Math.floor(Math.random() * excludeIndexes.length)];
            }
            
            randomIndex = validIndexes[Math.floor(Math.random() * validIndexes.length)];
            return randomIndex;
        }

        function swipeLeft() {
            if (currentIndex !== firstVideoIndex && videoHistory.length > 0) {
                currentIndex = videoHistory.pop();
                playVideo(currentIndex);
            }
        }

        function swipeRight() {
            if (currentIndex === firstVideoIndex) return; // Prevent swiping on the first video

            videoHistory.push(currentIndex);
            if (videoHistory.length > maxHistorySize) {
                videoHistory.shift(); // Keep the history size within the limit
            }
            if (videoList.length === 0) {
                // No more videos to choose from
                return;
            }
            currentIndex = getRandomIndex(videoHistory);
            if (currentIndex === firstVideoIndex) {
                // Avoid selecting the first video again
                currentIndex = getRandomIndex(videoHistory);
            }
            playVideo(currentIndex);
        }

        function handleTouchStart(evt) {
            const firstTouch = evt.touches[0];
            xDown = firstTouch.clientX;
            windowWidth = window.innerWidth;
        }

        function handleTouchMove(evt) {
            if (!xDown) {
                return;
            }

            let xUp = evt.touches[0].clientX;
            let xDiff = xDown - xUp;

            if (Math.abs(xDiff) > windowWidth * swipeThreshold) {
                interacted = true; // Set interacted to true on swipe
                if (xDiff > 0) {
                    swipeRight(); // Swipe right advances to a new random video
                } else {
                    swipeLeft(); // Swipe left goes back to the previous video
                }
                xDown = null; // Reset value
            }
        }

        let xDown = null;
        let windowWidth = window.innerWidth;

        document.addEventListener('touchstart', handleTouchStart, false);
        document.addEventListener('touchmove', handleTouchMove, false);

        // Redirect to the second video when the circle is clicked
        redirectCircle.addEventListener('click', () => {
            playVideo(1); // Play the second video (index 1)
        });

        // Initial video play
        playVideo(currentIndex);
    </script>
</body>
</html>
